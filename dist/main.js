var e={n:r=>{var n=r&&r.__esModule?()=>r.default:()=>r;return e.d(n,{a:n}),n},d:(r,n)=>{for(var t in n)e.o(n,t)&&!e.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:n[t]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};e.r(r);const n=require("module");var t=e.n(n);const o=require("path");var a=e.n(o);const i=require("child_process");var s=e.n(i);const c=require("fs");var l=e.n(c);const d=require("inspector");process.argv.join("").includes("--debug")&&((0,d.open)(),(0,d.waitForDebugger)());const p=require("sucrase"),u=require("sass"),m=require("electron"),y="dist"===a().basename(__dirname)?a().join(__dirname,"..","cache"):a().resolve(__dirname,"..","..","cache");l().existsSync(y)||l().mkdirSync(y),m.ipcMain.handle("pccompat-run-command",((e,r,n)=>new Promise(((e,t)=>{s().exec(r,{cwd:n},((r,n)=>{if(r)return t(r);e(n)}))})))),m.ipcMain.on("pccompat-get-app-path",(e=>{e.returnValue=m.app.getAppPath()})),m.ipcMain.on("pccompat-get-window-data",(e=>{e.returnValue=e.sender.kernelWindowData})),m.ipcMain.on("pccompat-compile-sass",((e,r)=>{let n="";try{n=u.compile(r).css.toString()}catch(r){e.sender.executeJavaScript(function(e){return`console.error(Object.assign(new Error(${JSON.stringify(e.message)}), {\n      stack: ${JSON.stringify(e.stack)},\n      name: ${JSON.stringify(e.name)}\n    }));`.trim()}(r))}e.returnValue=n})),m.ipcMain.on("pccompat-compile-jsx",((e,r)=>{if(!l().existsSync(r))return void(e.returnValue="");const n=l().readFileSync(r,"utf8");let t=0;for(let e=0;e<n.length;e++)t=(t<<5)-t+n.charCodeAt(e),t&=t;try{e.returnValue=l().readFileSync(a().join(y,t.toString()),"utf-8")}catch{const{code:o}=p.transform(n,{transforms:["jsx","imports","typescript"],filePath:r});l().writeFileSync(a().join(y,t.toString()),o),e.returnValue=o}})),m.ipcMain.handle("pccompat-open-devtools",((e,r)=>{const n=m.BrowserWindow.fromWebContents(e.sender);n&&(r&&!n.webContents.isDevToolsOpened()?n.webContents.openDevTools():n.webContents.closeDevTools())}));const _=a().resolve("dist"===a().basename(__dirname)?a().resolve(__dirname,".."):__dirname,"node_modules");if(!l().existsSync(_)&&!__dirname.includes(".asar"))try{(0,i.execSync)("npm install --production",{cwd:__dirname})}catch(e){console.error("Failed to automatically install node modules:",e)}t().globalPaths.push(_);var f=exports;for(var g in r)f[g]=r[g];r.__esModule&&Object.defineProperty(f,"__esModule",{value:!0});